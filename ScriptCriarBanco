CREATE SCHEMA IF NOT EXISTS punch_the_clock DEFAULT CHARACTER SET utf8mb4 ;
USE punch_the_clock;

CREATE TABLE IF NOT EXISTS plano (
  idPlano INT(11) NOT NULL AUTO_INCREMENT,
  preco DOUBLE NOT NULL,
  quantidadeFuncionario INT(11) NOT NULL,
  PRIMARY KEY (idPlano));
  
  CREATE TABLE IF NOT EXISTS empresa (
  idEmpresa INT(11)  AUTO_INCREMENT,
  nome VARCHAR(45) NOT NULL,
  CNPJ VARCHAR(14) NOT NULL,
  telefone VARCHAR(15) NULL DEFAULT NULL,
  planoId INT(11) NULL DEFAULT NULL,
  PRIMARY KEY (idEmpresa),
    FOREIGN KEY (planoId)
    REFERENCES punch_the_clock.plano (idPlano));

CREATE TABLE IF NOT EXISTS cargo (
  idCargo INT(11) AUTO_INCREMENT,
  descricao VARCHAR(45) NOT NULL,
  empresaId INT(11) NULL DEFAULT NULL,
  PRIMARY KEY (idCargo),
  FOREIGN KEY (empresaId)
    REFERENCES punch_the_clock.empresa (idEmpresa));
    
CREATE TABLE IF NOT EXISTS punch_the_clock.cargaHoraria (
  idCargaHoraria INT(11)  AUTO_INCREMENT,
  tipo VARCHAR(45) NOT NULL,
  cargaHoraria VARCHAR(14) NOT NULL,
  noturno BIT NOT NULL,
  quantidadeMarcacoes INT(11) NULL DEFAULT NULL,
  empresaId INT(11) NULL DEFAULT NULL,
  PRIMARY KEY (idCargaHoraria),
    FOREIGN KEY (empresaId)
    REFERENCES punch_the_clock.empresa (idEmpresa));
    
    
CREATE TABLE IF NOT EXISTS punch_the_clock.funcionario (
  idFuncionario INT(11) NOT NULL AUTO_INCREMENT,
  nome VARCHAR(45) NOT NULL,
  CPF VARCHAR(45) NOT NULL,
  dataNascimento DATE NOT NULL,
  dataContratação DATE NOT NULL,
  dataDemissão DATE,
  telefone VARCHAR(15) NULL DEFAULT NULL,
  sexo VARCHAR(15) NOT NULL,
  estadoCivil VARCHAR(45) NOT NULL,
  email VARCHAR(45) NOT NULL,
  senha VARCHAR(45) NOT NULL,
  empresaId INT(11) NOT NULL,
  cargoId INT(11) NOT NULL,
  cargaHorariaId INT(11) NOT NULL,
  PRIMARY KEY (idFuncionario),
    FOREIGN KEY (cargoId)
    REFERENCES punch_the_clock.cargo (idCargo),
     FOREIGN KEY (cargaHorariaId)
    REFERENCES punch_the_clock.cargaHoraria (idCargaHoraria),
    FOREIGN KEY (empresaId)
    REFERENCES punch_the_clock.empresa (idEmpresa));

    
CREATE TABLE IF NOT EXISTS punch_the_clock.pontos (
  idPontos INT(11)  AUTO_INCREMENT,
  dataMarcacao DATE NOT NULL,
  dataRegistro DATE NOT NULL,
  hora INT(11) NOT NULL,
  funcionarioId INT(11) NOT NULL,
  PRIMARY KEY (idPontos),
    FOREIGN KEY (funcionarioId)
    REFERENCES punch_the_clock.funcionario (idFuncionario));

CREATE TABLE IF NOT EXISTS punch_the_clock.bancoDeHoras (
  idBancoDeHoras INT(11)  AUTO_INCREMENT,
  horasTrabalhadas INT(11) NOT NULL,
  debito INT(11) NOT NULL,
  credito INT(11) NULL DEFAULT NULL,
  mesReferencia  DATE NOT NULL,
  funcionarioId INT(11) NOT NULL,
  PRIMARY KEY (idBancoDeHoras),
  FOREIGN KEY (funcionarioId)
  REFERENCES punch_the_clock.funcionario (idFuncionario));
  

    